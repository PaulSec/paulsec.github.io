
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>HTTP Security Headers on top 10k Alexa websites - My portfolio</title>
  <meta name="author" content="Paul A. (PaulSec)">

  
  <meta name="description" content="google.load("visualization", "1", {packages:["corechart"]}); google.setOnLoadCallback(drawChart); function drawChart() { // all headers var data = &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://paulsec.github.io/blog/2014/05/13/http-security-headers-on-top-10k-alexa-websites">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My portfolio" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Quattrocento+Sans|Roboto:400,300' rel='stylesheet' type='text/css'>

  

</head>


<body>
	<div class="container">
		<aside class="left">
			<div class="inner-left">
				<header>
					
  <img src="http://www.gravatar.com/avatar/0b0f4cb32c81edd3e8dca37bde08910c?s=200" alt="Gravatar of Paul A. (PaulSec) " title="Gravatar of Paul A. (PaulSec)" class="profilepic" />

<hgroup>
  <h1><a href="/">My portfolio</a></h1>
  
    <h2 class="subtitle">Blog of a (Web) Security enthusiast.</h2>
   
</hgroup>


				</header>
				<footer>
					<p>
	
	
</p>
				</footer>
			</div>
		</aside>
    	<section class="right">
    		<div class="inner-right">
    			<div id="posts">
    			  	<article class="post">
    
  <header>
    
      <h1 class="entry-title">HTTP Security Headers on Top 10k Alexa Websites</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-13T18:32:58+02:00" pubdate data-updated="true">May 13<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><script type="text/javascript" src="https://www.google.com/jsapi"></script>


<script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        // all headers
        var data = google.visualization.arrayToDataTable([
          ['Header', 'Value'],
          ['X-Frame-Options', 799],
          ['X-XSS-Protection', 374],
          ['X-Content-Type-Options', 202],
          ['Strict-Transport-Security', 97],
          ['Content-Security-Policy', 16],
          ['Content-Security-Policy-Report-Only', 2]
        ]);

        var options = {
          title: 'Presence of Security Headers'
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('hosts-up'));
        chart.draw(data, options);

        // X-Frame-Options
        var data = google.visualization.arrayToDataTable([
          ['Value', 'Occurence'],  
          ['SAMEORIGIN', 665],
          ['DENY', 127],
          ['ALLOW-FROM', 5],
          ['ALLOWALL', 1],
          ['GOFORIT', 1]
        ]);

        var options = {
          title: 'X-Frame-Options Statistics'
        };

        var chart = new google.visualization.PieChart(document.getElementById('x-frame-options-stats'));
        chart.draw(data, options);

        // X-XSS-Protection
        var data = google.visualization.arrayToDataTable([
          ['Value', 'Occurence'],  
          ['1; mode=block', 340],
          ['0', 24],
          ['1', 10]
        ]);

        var options = {
          title: 'X-XSS-Protection Statistics'
        };

        var chart = new google.visualization.PieChart(document.getElementById('x-xss-protection-stats'));
        chart.draw(data, options);

        // Strict-Transport-Security
        var data = google.visualization.arrayToDataTable([
          ['Value', 'Occurence'],  
          ['Only max-age', 68],
          ['max-age and includeSubDomains', 29]
        ]);

        var options = {
          title: 'Strict-Transport-Security Statistics'
        };

        var chart = new google.visualization.PieChart(document.getElementById('strict-transport-security-stats'));
        chart.draw(data, options);

        // max-age statistics
        var data = google.visualization.arrayToDataTable([
          ['Value', 'Occurence'],  
          ['1', 1],
          ['600', 1],
          ['3600', 1],
          ['14400', 1],
          ['86400', 1],
          ['86400', 1],
          ['864000', 1],
          ['1728000', 1],
          ['2592000', 1],
          ['2592000', 1],
          ['3000000', 1],
          ['5184000', 1],
          ['7776000', 1],
          ['8640000', 1],
          ['10886400', 1],
          ['15552000', 1],
          ['15768000', 1],
          ['15768000', 1],
          ['16070400', 1],
          ['31556926', 1],
          ['31557600', 1],
          ['47336400', 1],
          ['63072000', 1],
          ['86400000', 1],
          ['631152000', 1],
          ['31556926', 2],
          ['63072000', 2],
          ['631138519', 2],
          ['15768000', 4],
          ['604800', 5],
          ['10893354', 7],
          ['0', 8],
          ['31536000', 8],
          ['31536000', 32]
        ]);

        var options = {
          title: 'Max-age Statistics'
        };

        var chart = new google.visualization.PieChart(document.getElementById('max-age-stats'));
        chart.draw(data, options);

      }
</script>


<p><strong>EDIT</strong>: Added statistics of <em>max-age</em> option.</p>

<p>Hi there,</p>

<p>This blog post deals with HTTP Security Headers on top 10k Alexa websites.
Based on <a href="https://www.reddit.com/r/netsec/comments/254om6/how_common_are_http_security_headers_really_lzone/">this</a>  discussion on <a href="https://www.reddit.com/r/netsec/">netsec</a>, I decided to do some statistics on Alexa ranking.</p>

<p>To do this study, I did a GET HTTP Request and saved the headers in the HTTP response. This has been done using Python.</p>

<p>First of all, I scanned 10000 hosts. 555 hosts didn&rsquo;t respond so those statistics are based on <strong>9445</strong> hosts.</p>

<p>Then, I checked the presence of HTTP security Headers.
OWASP provides a good resource <a href="https://www.owasp.org/index.php/List_of_useful_HTTP_headers">here</a> where they define HTTP Security Headers.</p>

<p>Basically, I checked the presence of those ones:</p>

<ul>
<li>X-Frame-Options</li>
<li>X-XSS-Protection</li>
<li>X-Content-Type-Options</li>
<li>Strict-Transport-Security</li>
<li>Content-Security-Policy</li>
<li>Content-Security-Policy-Report-Only</li>
</ul>


<p>Here are the results:</p>

<div id="hosts-up" style="width: 900px; height: 500px;"></div>


<p>Then, I decided to realize statistics on the different values for some of the most used HTTP header.</p>

<h3>X-Frame-Options</h3>

<div id="x-frame-options-stats" style="width: 900px; height: 500px;"></div>


<h3>X-XSS-Protection</h3>

<div id="x-xss-protection-stats" style="width: 900px; height: 500px;"></div>


<h3>Strict-Transport-Security</h3>

<div id="strict-transport-security-stats" style="width: 900px; height: 500px;"></div>


<h4>Max-age statistics</h4>

<div id="max-age-stats" style="width: 900px; height: 500px;"></div>


<h3>X-Content-Type-Options</h3>

<p>This header doesn&rsquo;t allow options so the only value is <code>NOSNIFF</code>.
All <strong>202</strong> hosts had this value.</p>

<p>Hope you liked it and that it gave you updated information about the (bad, unfortunately) usage of Security headers.</p>
</div>


</article>


        <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://paulsec.github.io/blog/2014/05/13/http-security-headers-on-top-10k-alexa-websites/" data-via="" data-counturl="http://paulsec.github.io/blog/2014/05/13/http-security-headers-on-top-10k-alexa-websites/" >Tweet</a>
  
  
  
</div>





    			</div>
    			<footer id="footer">
    				<p class="credit">
  Copyright &copy; 2014 - Paul A. (PaulSec). Powered by <a href="http://octopress.org">Octopress</a>
</p>


    			</footer>
    			







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<link href='http://fonts.googleapis.com/css?family=Quattrocento+Sans|Roboto:400,300' rel='stylesheet' type='text/css'>





    		</div>
    	</section>
  	</div>
</body>
</html>
